<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link href="../../../webapp/css/item.css" th:href="@{/main/webapp/css/item.css}" rel="stylesheet"/>
</head>
<body>
<header th:insert="blocks/header :: header"></header>

<div class="container mt-5">

    <div class="container mt-5">
        <p th:text="${'TOTAL USERS: ' + totalUsers}" class="fs-2"></p>
    </div>
    <nav aria-label="...">
        <ul class="pagination">

            <li class="page-item" th:class="${currentPage == 1} ? 'page-item disabled'">
                <a class="page-link" th:if="${currentPage > 1}"
                   th:href="@{'/admin/users/page/1' + '?sortField=' + ${sortField} +'&sortDir=' + ${sortDir}}">
                    First
                </a>
                <a class="page-link" th:unless="${currentPage != 1}">First</a>
            </li>

            <li class="page-item" th:class="${currentPage < 2} ? 'page-item disabled'">
                <a class="page-link" th:if="${currentPage > 1}"
                   th:href="@{'/admin/users/page/' + ${currentPage - 1}  + '?sortField=' + ${sortField} +'&sortDir=' + ${sortDir}}">
                    Previous
                </a>
                <a class="page-link" th:unless="${currentPage > 1}">Previous</a>
            </li>

            <li class="page-item" th:each="i: ${#numbers.sequence(1, totalPages)}"
                th:class="${i == currentPage} ? 'page-item active'">
                <a class="page-link" th:if="${i != currentPage}"
                   th:href="@{'/admin/users/page/' + ${i} + '?sortField=' + ${sortField} +'&sortDir=' + ${sortDir}}">[[${i}]]</a>
                <a class="page-link" th:unless="${i != currentPage}">[[${i}]]</a>
            </li>

            <li class="page-item" th:class="${currentPage == totalPages} ? 'page-item disabled'">
                <a class="page-link" th:if="${currentPage < totalPages}"
                   th:href="@{'/admin/users/page/' + ${currentPage + 1}  + '?sortField=' + ${sortField} +'&sortDir=' + ${sortDir}}">
                    Next
                </a>
                <a class="page-link" th:unless="${currentPage != totalPages}">Next</a>
            </li>

            <li class="page-item" th:class="${currentPage == totalPages} ? 'page-item disabled'">
                <a class="page-link" th:if="${currentPage < totalPages}"
                   th:href="@{'/admin/users/page/' + ${totalPages}  + '?sortField=' + ${sortField} +'&sortDir=' + ${sortDir}}">
                    Last
                </a>
                <a class="page-link" th:unless="${currentPage != totalPages}">Last</a>
            </li>
        </ul>
    </nav>

    <table class="table">
        <thead>
        <tr>
            <th id="id" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=id&sortDir=' + ${reversSortDir}}">Id</a>
            </th>
            <th id="login" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=login&sortDir=' + ${reversSortDir}}">Login</a>
            </th>
            <th id="first_name" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=firsName&sortDir=' + ${reversSortDir}}">First
                    name</a>
            </th>
            <th id="last_name" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=lastName&sortDir=' + ${reversSortDir}}">Last
                    name</a>
            </th>
            <th id="email" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=email&sortDir=' + ${reversSortDir}}">Email</a>
            </th>
            <th id="role" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=roles&sortDir=' + ${reversSortDir}}">Role</a>
            </th>
            <th id="status" scope="col">
                <a th:href="@{'/admin/users/page/' + ${currentPage} + '?sortField=statusUser&sortDir=' + ${reversSortDir}}">Status</a>
            </th>
            <th id="actions" scope="col">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${users}">
            <td headers="id" th:text="${user.id}"></td>
            <td headers="login" th:text="${user.login}"></td>
            <td headers="first_name" th:text="${user.firstName}"></td>
            <td headers="last_name" th:text="${user.lastName}"></td>
            <td headers="email" th:text="${user.email}"></td>
            <td headers="role" th:text="${user.role}"></td>
            <td headers="status" th:text="${user.status}"></td>

            <td headers="actions">
                <div class="btn-group" role="group" aria-label="Basic outlined example">
                    <form action="/admin/users/change-role" method="POST">
                        <input type="text" name="id" th:value="${user.id}" hidden>
                        <input type="text" name="currentPage" th:value="${currentPage}" hidden>
                        <input type="text" name="sortField" th:value="${sortField}" hidden>
                        <input type="text" name="sortDir" th:value="${sortDir}" hidden>

                        <button th:if="${user.role =='[USER]'}" type="submit" class="btn btn-outline-primary">
                            SET ADMIN
                        </button>
                        <button th:if="${user.role =='[ADMIN]'}" type="submit" class="btn btn-outline-primary">
                            SET USER
                        </button>
                    </form>

                    <form action="/admin/users/change-status" method="POST">
                        <input type="text" name="id" th:value="${user.id}" hidden>
                        <input type="text" name="currentPage" th:value="${currentPage}" hidden>
                        <input type="text" name="sortField" th:value="${sortField}" hidden>
                        <input type="text" name="sortDir" th:value="${sortDir}" hidden>

                        <button th:if="${user.status =='ACTIVE'}" type="submit" class="btn btn-outline-primary">
                            BLOCK
                        </button>
                        <button th:if="${user.status =='BLOCKED'}" type="submit" class="btn btn-outline-primary">
                            UNBLOCK
                        </button>
                    </form>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<footer th:insert="blocks/footer :: footer"></footer>
</body>
</html>